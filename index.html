<!DOCTYPE html>
<html>
  <head>
  </head>
  <body>
    <script type="application/javascript">
      const container = document.createElement('div')
      container.style.maxWidth = '600px';
      container.style.margin = '0 auto';
      container.style.border = '1px solid #ccc';
      container.style.borderRadius = '8px';
      container.style.overflow = 'hidden';
      container.style.backgroundColor = '#fff';
      container.style.padding = '10px';
      document.body.append(container)
    
      const ul = document.createElement('ul')
      ul.style.overflowY = 'scroll';
      ul.style.maxHeight = '300px';
      document.body.append(ul)

      const t = document.createElement('textarea')
      t.style.width = 'calc(100% - 20px)';
      t.style.padding = '10px';
      t.style.boxSizing = 'border-box';
      t.style.margin = '10px 0';
      t.style.border = '1px solid #ccc';
      t.style.borderRadius = '4px';
      document.body.append(t)

      const b = document.createElement('button')
      b.style.width = 'calc(100% - 20px)';
      b.style.padding = '10px';
      b.style.boxSizing = 'border-box';
      b.style.margin = '0';
      b.style.backgroundColor = '#4CAF50';
      b.style.color = 'white';
      b.style.border = 'none';
      b.style.borderRadius = '4px';
      b.style.cursor = 'pointer';
      b.textContent = 'SEND';
      b.append('SEND')
      document.body.append(b)

      container.append(ul, t, b);

      aaa

      //function to get the messages
      const getMessages = async () => {
        const response = await fetch('https://chat.tiburoncin.lat/messages')
        const messages = await response.json()
        
        messages.forEach((message) => {
          const li = document.createElement('p')
          li.textContent = `${message.username}: ${message.message}`;
          ul.append(li)
        })
      }

      //DataBase Connection
      const postMessage = async () => {
        console.log(t.value)
        const body = {
          username: 'Sebastian',
          message: t.value,
        }
        const response = await fetch('https://chat.tiburoncin.lat/messages',
        {
          method: 'POST',
          body: JSON.stringify(body)
        })
        ul.innerHTML = ""
        getMessages()
      }

      //show message
      b.addEventListener('click', postMessage)

      //get messages
      getMessages()
    </script>
  </body>
</html>